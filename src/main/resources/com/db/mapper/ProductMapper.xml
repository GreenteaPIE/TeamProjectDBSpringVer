<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.db.mapper.ProductMapper">

	<!-- 메인 브랜드 리스트 -->
	<select id="brandList" resultType="com.db.model.BrandVO">

		select * from brand

	</select>

	<!-- 브랜드 상품 리스트 -->
	<select id="brandProductList"
		resultType="com.db.model.ProductVO">

		SELECT num, pGender, bName, kind, pName, imgUrl, pSize,
		balance,
		price, purchasedNum, explain, writedate, readcount FROM
		(SELECT num,
		pGender, bName, kind, pName, imgUrl, pSize, balance,
		price,
		purchasedNum, explain, writedate, readcount, ROW_NUMBER() OVER
		(PARTITION BY pName ORDER BY num) RN FROM PRODUCT WHERE bname LIKE
		#{bname} )WHERE RN = 1

	</select>

	<!-- 브랜드 상품 카테고리TOP 리스트 -->
	<select id="brandCateGoriesTopList"
		resultType="com.db.model.ProductVO">

		SELECT num, pGender, bName, kind, pName, imgUrl, pSize,
		balance, price, purchasedNum, explain, writedate, readcount
		FROM (
		SELECT num, pGender, bName, kind, pName, imgUrl, pSize, balance, price,
		purchasedNum, explain, writedate, readcount,
		ROW_NUMBER() OVER (PARTITION BY pName ORDER BY num) RN
		FROM PRODUCT
		WHERE bname LIKE #{bname} AND kind = 1
		)
		WHERE RN = 1

	</select>

	<!-- 브랜드 상품 카테고리Bottom 리스트 -->
	<select id="brandCateGoriesBottomList"
		resultType="com.db.model.ProductVO">

		SELECT num, pGender, bName, kind, pName, imgUrl, pSize,
		balance, price, purchasedNum, explain, writedate, readcount
		FROM (
		SELECT num, pGender, bName, kind, pName, imgUrl, pSize, balance, price,
		purchasedNum, explain, writedate, readcount,
		ROW_NUMBER() OVER (PARTITION BY pName ORDER BY num) RN
		FROM PRODUCT
		WHERE bname LIKE #{bname} AND kind = 2
		)
		WHERE RN = 1

	</select>
	
	<!-- 브랜드 상품 카테고리Bouti 리스트 -->
	<select id="brandCateGoriesBoutiList"
		resultType="com.db.model.ProductVO">

		SELECT num, pGender, bName, kind, pName, imgUrl, pSize,
		balance, price, purchasedNum, explain, writedate, readcount
		FROM (
		SELECT num, pGender, bName, kind, pName, imgUrl, pSize, balance, price,
		purchasedNum, explain, writedate, readcount,
		ROW_NUMBER() OVER (PARTITION BY pName ORDER BY num) RN
		FROM PRODUCT
		WHERE bname LIKE #{bname} AND kind = 3
		)
		WHERE RN = 1

	</select>

	<!-- 상품 검색 리스트 -->
	<select id="searchProduct" resultType="com.db.model.ProductVO">

		SELECT num, pGender, bName, kind, pName, imgUrl, pSize, balance, price,
		purchasedNum, explain, writedate, readcount
		FROM (
		SELECT num, pGender, bName, kind, pName, imgUrl, pSize, balance, price,
		purchasedNum, explain, writedate, readcount,
		ROW_NUMBER() OVER (PARTITION BY pName ORDER BY num) RN
		FROM PRODUCT
		WHERE pname LIKE '%' ||#{pname}|| '%'
		)
		WHERE RN = 1

	</select>
	
	<!-- 상품 상세보기 -->
	<select id="productDetail" resultType="com.db.model.ProductVO">
	
	select * from product where num = #{num}
	
	</select>
	
	<!-- 상품 사이즈 리스트 -->
	<select id="productSizeList" resultType="com.db.model.ProductVO">
	
	select psize from product where pname = #{pname} 
	
	</select>
	
</mapper>